/**
 * Hilo 1.0.1 for cmd
 * Copyright 2016 alibaba.com
 * Licensed under the MIT License
 */
define(function(e,t,a){var i=e("hilo/core/Class"),r=e("hilo/core/Hilo"),s=e("hilo/renderer/Renderer"),n=i.create({Extends:s,constructor:function(e){n.superclass.constructor.call(this,e),this.context=this.canvas.getContext("2d")},renderType:"canvas",context:null,startDraw:function(e){return!!(e.visible&&e.alpha>0)&&(e===this.stage&&this.context.clearRect(0,0,e.width,e.height),this.context.save(),!0)},draw:function(e){var t=this.context,a=e.width,i=e.height,r=e.background;r&&(t.fillStyle=r,t.fillRect(0,0,a,i));var s=e.drawable,n=s&&s.image;if(n){var c=s.rect,h=c[2],l=c[3],o=c[4],d=c[5];if(!h||!l)return;a||i||(a=e.width=h,i=e.height=l),(o||d)&&t.translate(o-.5*h,d-.5*l),t.drawImage(n,c[0],c[1],h,l,0,0,a,i)}},endDraw:function(e){this.context.restore()},transform:function(e){var t=e.drawable;if(t&&t.domElement)return void r.setElementStyleByView(e);var a=this.context,i=e.scaleX,s=e.scaleY;if(e===this.stage){var n=this.canvas.style,c=e._scaleX,h=e._scaleY,l=!1;(!c&&1!=i||c&&c!=i)&&(e._scaleX=i,n.width=i*e.width+"px",l=!0),(!h&&1!=s||h&&h!=s)&&(e._scaleY=s,n.height=s*e.height+"px",l=!0),l&&e.updateViewport()}else{var o=e.x,d=e.y,v=e.pivotX,f=e.pivotY,g=e.rotation%360,u=e.mask;u&&(u._render(this),a.clip());var w=e.align;if(w)if("function"==typeof w)e.align();else{var p=e.parent;if(p){var x=e.width,b=e.height,m=p.width,k=p.height;switch(w){case"TL":o=0,d=0;break;case"T":o=m-x>>1,d=0;break;case"TR":o=m-x,d=0;break;case"L":o=0,d=k-b>>1;break;case"C":o=m-x>>1,d=k-b>>1;break;case"R":o=m-x,d=k-b>>1;break;case"BL":o=0,d=k-b;break;case"B":o=m-x>>1,d=k-b;break;case"BR":o=m-x,d=k-b}}}0==o&&0==d||a.translate(o,d),0!=g&&a.rotate(g*Math.PI/180),1==i&&1==s||a.scale(i,s),0==v&&0==f||a.translate(-v,-f)}e.alpha>0&&(a.globalAlpha*=e.alpha)},remove:function(e){var t=e.drawable,a=t&&t.domElement;if(a){var i=a.parentNode;i&&i.removeChild(a)}},clear:function(e,t,a,i){this.context.clearRect(e,t,a,i)},resize:function(e,t){var a=this.canvas,i=this.stage,r=a.style;a.width=e,a.height=t,r.width=i.width*i.scaleX+"px",r.height=i.height*i.scaleY+"px"}});return n});